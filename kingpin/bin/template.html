<!DOCTYPE html>
<html>
<head>
    <!--
    This template expects orgchart.json to be in the same directory as this file.
    Orgchart can be generated by running kingpin with "build-only" and "orgchart" flags.
    To solve the XHR issue with browsers reading file:/// you can use python web server
    python -m SimpleHTTPServer
    -->
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>


</head>
<body>
<div id="kp_actors_chart"></div>
<script type="text/javascript">
    google.charts.load('current', {packages:["orgchart"]});
    google.charts.setOnLoadCallback(drawChart);
    function drawChart() {
        var data = new google.visualization.DataTable();
        data.addColumn('string', 'Name');
        data.addColumn('string', 'Manager');
        data.addColumn('string', 'ToolTip');


        $.getJSON('./orgchart.json', function(raw_data) {
            var row_definition = Array();
            for (var i in raw_data) {
                row_definition.push([
                    {'v': raw_data[i].id, 'f': raw_data[i].desc},
                    raw_data[i].parent_id,
                    raw_data[i].class,
                ])
            }

            data.addRows(row_definition);

            var chart = new google.visualization.OrgChart(document.getElementById('kp_actors_chart'));
            chart.draw(data, {
              allowHtml: true,
              allowCollapse: true,
              size: 'small'});
        });
    }
</script>
</body>
</html>
